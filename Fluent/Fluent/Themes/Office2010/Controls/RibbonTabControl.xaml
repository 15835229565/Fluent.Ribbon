<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Fluent="clr-namespace:Fluent">
    <Style x:Key="RibbonTabControlStyle" TargetType="{x:Type Fluent:RibbonTabControl}">
    	<Setter Property="VerticalAlignment" Value="Top"/>
    	<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type Fluent:RibbonTabControl}">
					<Grid x:Name="ContentGrid" Height="Auto" VerticalAlignment="Top">
						<Grid.RowDefinitions>
							<RowDefinition Height="24"/>
							<RowDefinition x:Name="rowDefinition" Height="86"/>
							<RowDefinition x:Name="rowDefinition1" Height="5"/>
						</Grid.RowDefinitions>
						<Border x:Name="border" HorizontalAlignment="Stretch" Margin="0,-1,0,0" Width="Auto" BorderBrush="#FFB6BABF" BorderThickness="0,1" Grid.Row="1">
							<Border.Background>
								<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
									<GradientStop Color="White" Offset="0"/>
									<GradientStop Color="#FFE5E9EE" Offset="1"/>
								</LinearGradientBrush>
							</Border.Background>
						</Border>
						<Rectangle x:Name="rectangle" Stroke="{x:Null}" Margin="0" Width="Auto" Grid.RowSpan="1" StrokeThickness="0" Grid.Row="2">
							<Rectangle.Fill>
								<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
									<GradientStop Color="#4C000000" Offset="0"/>
									<GradientStop Offset="1"/>
								</LinearGradientBrush>
							</Rectangle.Fill>
						</Rectangle>
						<Border HorizontalAlignment="Stretch" Margin="1,0,1,1" Grid.Row="1" Grid.RowSpan="1">
						<ContentControl x:Name="mainContentControl">
							<ContentPresenter x:Name="contentPresenter" ContentSource="SelectedContent" Margin="1"/>
						</ContentControl>
						</Border>
						<Grid x:Name="TabsGrid" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Grid.RowSpan="1">
							<Fluent:RibbonTabsContainer HorizontalAlignment="Stretch" Width="Auto" IsItemsHost="True" Margin="60,0,0,0"/>							
						</Grid>
						<Popup x:Name="PART_Popup" PlacementTarget="{Binding ElementName=TabsGrid, Mode=OneWay}" StaysOpen="True" IsOpen="{TemplateBinding IsOpen}" AllowsTransparency="True" PopupAnimation="Fade">
							<Border Width="{Binding ActualWidth, ElementName=ContentGrid, Mode=Default}" Height="86" BorderBrush="#FFB8B8B8">
								<Border.Background>
									<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
										<GradientStop Color="White" Offset="0"/>
										<GradientStop Color="#FFE5E9EE" Offset="0.974"/>
									</LinearGradientBrush>
								</Border.Background>
								<ContentControl x:Name="contentControl"/>
							</Border>
						</Popup>
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger Property="IsMinimized" Value="True">
							<Setter Property="Height" TargetName="rowDefinition" Value="0"/>
							<Setter Property="Height" TargetName="rowDefinition1" Value="0"/>
							<Setter Property="Visibility" TargetName="border" Value="Collapsed"/>
							<Setter Property="Visibility" TargetName="rectangle" Value="Collapsed"/>
							<Setter Property="Content" TargetName="mainContentControl" Value="{x:Null}"/>
							<Setter Property="Content" TargetName="contentControl" Value="{Binding ElementName=contentPresenter, Mode=OneWay}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
    </Style>
</ResourceDictionary>